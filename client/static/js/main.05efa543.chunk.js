(this["webpackJsonpnico.drive.client"]=this["webpackJsonpnico.drive.client"]||[]).push([[0],{220:function(e,t){},222:function(e,t){},313:function(e,t,n){},314:function(e,t,n){},315:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(39),o=n.n(i),c=n(13),s=n(12),l=n(14),d=n(15),u=n(149),p=n(145),j=Object(p.merge)({},u.a,{typography:{fontFamilies:{display:"Lato, sans-serif",ui:"Lato, sans-serif",mono:'"SF Mono", monospace'}},components:{Text:{baseStyle:{fontFamily:"Lato, sans-serif"}},Heading:{baseStyle:{fontFamily:"Lato, sans-serif"}},Link:{baseStyle:{fontFamily:"Lato, sans-serif"}}}}),h=n(60),f=n(2),g={authType:h.AuthType.Basic,username:"",davClient:null,davBaseUrl:null,davApiBaseUrl:null,davHomeDirectory:null,connectionValid:!1,supportedFormats:["JPEG","JPG","PNG","WEBP","AVIF","TIFF","TIF","GIF","SVG","CR2","DNG"],filter:"",filterRegExp:new RegExp(".*","i"),filterFileItems:function(e){},setDavClient:function(e,t){},getThumbApiUrl:function(){},getExifApiUrl:function(){},getMetadataApiUrl:function(){},getAuthUrl:function(){},isImageFile:function(){},disconnect:function(){},getUserRootDirectories:function(){}},b=a.a.createContext(g),x=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).filterFileItems=function(t){var n=null===t||""===t?".*":t;e.setState({filter:t,filterRegExp:new RegExp(n,"i")})},e.setDavClient=function(t,n,r){var a=t?new URL(n):null,i=t?a.protocol:null,o=t?a.hostname:null,c=t?a.port:null,s="".concat(i,"//").concat(o,":").concat(c);e.setState({davClient:t,davBaseUrl:n,davApiBaseUrl:s,connectionValid:!!t,username:t?r:""})},e.disconnect=function(){e.setDavClient(null)},e.getThumbApiUrl=function(){return"".concat(e.state.davApiBaseUrl,"/thumb")},e.getExifApiUrl=function(){return"".concat(e.state.davApiBaseUrl,"/meta/exif")},e.getMetadataApiUrl=function(){return"".concat(e.state.davApiBaseUrl,"/meta/xmp")},e.getAuthUrl=function(){return"".concat(e.state.davApiBaseUrl,"/auth")},e.isImageFile=function(t){if("undefined"===typeof t||null===t)return!1;if(t.startsWith("."))return!1;var n=t.lastIndexOf(".");if(n<0)return!1;var r=t.toUpperCase().substring(n+1);return-1!==e.state.supportedFormats.indexOf(r)},e.render=function(){return Object(f.jsx)(b.Provider,{value:e.state,children:e.props.children})},e.state={authType:h.AuthType.Basic,username:"",davClient:null,davBaseUrl:null,davApiBaseUrl:null,davHomeDirectory:null,connectionValid:!1,showConnectionDialog:!1,supportedFormats:["JPEG","JPG","PNG","WEBP","AVIF","TIFF","GIF","SVG","CR2","DNG"],filter:"",filterRegExp:new RegExp(".*","i"),filterFileItems:e.filterFileItems,setDavClient:e.setDavClient,getThumbApiUrl:e.getThumbApiUrl,getExifApiUrl:e.getExifApiUrl,getMetadataApiUrl:e.getMetadataApiUrl,getAuthUrl:e.getAuthUrl,isImageFile:e.isImageFile,disconnect:e.disconnect},e}return Object(c.a)(n)}(r.Component),m=n(147),O=n(87),v=n(9),y=n(38),D=n(23),C=n.n(D),w=n(150),T=n(24),I=n(103),F=n(374),S=n(342),k=n(379),A=n(47),R=n(348),L=n(104),M=n(41),B=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){e.setState({errorMessage:""})},e.componentDidUpdate=function(t,n){n.username!==e.state.username&&e.fetchUserRootDirectories(),n.url!==e.state.url&&e.fetchUserRootDirectories(),null!==e.context.davClient&&e.context.connectionValid&&e.setState({connectionSuccess:!0})},e.fetchUserRootDirectories=function(){if(""!==e.state.username){var t="".concat(e.state.url,"auth/whois/").concat(e.state.username);return fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){return e.setState({userRootDirs:t.rootDirs,errorMessage:""}),t.rootDirs})).catch((function(t){console.log("Error while fetching user's root directories: ".concat(t)),e.setState({userRootDirs:[],errorMessage:"Error while fetching your directories: check your username or the server URL."})}))}},e.testConnection=Object(y.a)(C.a.mark((function t(){var n,r,a;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.info("Testing connection ..."),n={authType:h.AuthType.Basic,username:e.state.username,password:e.state.password},r="".concat(e.state.url).concat(e.state.davContext,"/").concat(e.state.username).concat(e.state.selectedRootDir),(a=Object(h.createClient)(r,n)).getDirectoryContents("/").then((function(t){e.context.setDavClient(a,r,e.state.username)})).catch((function(t){console.info("Could not connect to webdav: ".concat(t)),e.context.setDavClient(null,""),e.setState({errorMessage:"Something went wrong while connecting. Check your credentials and try again.",isLoading:!1,connectionSuccess:!1})}));case 5:case"end":return t.stop()}}),t)}))),e.onConfirm=function(){e.setState({isLoading:!0,connectionSuccess:!1},(function(){return e.testConnection()}))},e.onTxtLoginChange=function(t){e.setState({username:t.target.value})},e.isLoginButtonDisabled=function(){return null===e.state.username||""===e.state.username||null===e.state.password||""===e.state.password||""===e.state.selectedRootDir||""!==e.state.errorMessage||""===e.state.url||e.state.isLoading},e.renderErrorMessage=function(){return""!==e.state.errorMessage?Object(f.jsx)(w.a,{intent:"danger",children:e.state.errorMessage}):Object(f.jsx)(f.Fragment,{})},e.renderLoginForm=function(){return Object(f.jsxs)(T.a,{display:"grid",gridTemplateColumns:"auto",margin:160,padding:20,elevation:1,children:[Object(f.jsx)(T.a,{marginTop:-20,marginLeft:-20,marginRight:-20,marginBottom:40,padding:10,background:"tint2",elevation:1,children:Object(f.jsx)(I.a,{is:"h2",textAlign:"center",textShadow:"initial",children:"Welcome to Nico's Drive"})}),Object(f.jsxs)("form",{children:[Object(f.jsx)(F.a,{id:"txt-login",disabled:e.state.isLoading,value:e.state.username,onChange:e.onTxtLoginChange,placeholder:"Login name...",label:"Login:",autoComplete:"username"}),Object(f.jsx)(F.a,{id:"txt-password",disabled:e.state.isLoading,type:"password",value:e.state.password,onChange:function(t){return e.setState({password:t.target.value})},placeholder:"Password...",label:"Password:",autoComplete:"current-password"}),Object(f.jsx)(S.a,{children:"Online drive to connect to:"}),Object(f.jsx)(k.a,{items:e.state.userRootDirs,onChange:function(t){return e.setState({selectedRootDir:t})},placeholder:"Select one online drive...",marginBottom:20,label:"Online drive to connect to:"}),Object(f.jsx)(F.a,{id:"txt-url",disabled:e.state.isLoading,value:e.state.url,onChange:function(t){return e.setState({url:t.target.value})},placeholder:"Server url...",label:"Base server URL:",description:"Advanced users only."}),Object(f.jsxs)(T.a,{children:[e.renderErrorMessage(),Object(f.jsx)(A.a,{is:"div",marginTop:16,iconBefore:R.a,appearance:"primary",intent:"success",onClick:function(){return e.onConfirm()},disabled:e.isLoginButtonDisabled(),children:e.state.isLoading?"Please wait...":"Connect"}),Object(f.jsx)(L.a,{textAlign:"right",children:Object(f.jsx)(M.a,{children:"Not a member ? Just kindly ask... :)"})})]})]})]})},e.render=function(){return e.state.connectionSuccess?Object(f.jsx)(v.a,{to:"/explorer"}):e.renderLoginForm()};var r="".concat(window.location.protocol,"//").concat(window.location.hostname,":").concat(window.location.port,"/");return e.state={isLoading:!1,username:"",password:"",url:r,userRootDirs:[],selectedRootDir:"",errorMessage:"",davContext:"dav",connectionSuccess:!1},e}return Object(c.a)(n)}(r.Component);B.contextType=b;var U=n(318),N=n(383),E=n(349),z=n(372),G=n(344),H=n(373),P=n(381),W=n(377),_=n(340),V=n(350),J=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(){return Object(f.jsxs)(T.a,{background:"tint2",display:"grid",gridTemplateColumns:"1fr auto",paddingTop:15,paddingBottom:15,paddingLeft:15,justifyItems:"stretch",children:[Object(f.jsx)(E.a,{placeholder:"Search something...",width:"75%",justifySelf:"center",onChange:function(t){return e.context.filterFileItems(t.target.value)},value:e.context.filter}),Object(f.jsx)(z.a,{justifySelf:"end",position:G.a.BOTTOM_RIGHT,content:Object(f.jsxs)(H.a,{children:[Object(f.jsxs)(H.a.Group,{children:[Object(f.jsx)(H.a.Item,{icon:_.a,intent:"success",children:Object(f.jsx)(P.a,{color:"green",children:e.context.username})}),Object(f.jsx)(H.a.Item,{children:e.context.davBaseUrl})]}),Object(f.jsx)(H.a.Divider,{}),Object(f.jsx)(H.a.Group,{children:Object(f.jsx)(H.a.Item,{icon:V.a,intent:"danger",onClick:function(){e.context.disconnect()},children:"Disconnect"})})]}),children:Object(f.jsx)(W.a,{name:e.context.username,size:32,marginLeft:15,marginRight:15,style:{cursor:"pointer"},justifySelf:"end"})})]})},e}return Object(c.a)(n)}(r.Component);J.contextType=b;var X=J,K=n(353),Y=n(354),q=n(371),Q=n(355),Z=n(382),$=n(323),ee=n(356),te=n(351),ne=n(352),re=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(){var t=[],n=e.props.rating?e.props.rating:0,r=e.props.maxRating?e.props.maxRating:5;r<n&&(r=n);for(var a=e.props.size?e.props.size:24,i=0;i<n;i++){var o=Object(f.jsx)(te.a,{color:"#FBE6A2",size:a},i);t.push(o)}for(var c=n;c<r;c++){var s=Object(f.jsx)(ne.a,{color:"#C7CED4",size:a},c);t.push(s)}return Object(f.jsx)(T.a,{display:"inline-fex",alignItems:"center",children:t})},e}return Object(c.a)(n)}(r.Component),ae=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){e.loadImageInformation(),e.loadMetaDataInformation()},e.getDownloadLink=function(){if(e.context.connectionValid)return e.context.davClient.getFileDownloadLink(e.props.fileItem.filename)},e.loadImageInformation=function(){var t=e.context.getExifApiUrl(),n=e.context.davBaseUrl.split("/"),r="/".concat(n[n.length-1]),a={username:e.context.username,homeDir:r,filename:e.props.fileItem.filename};fetch(t,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({imageData:t})})).catch((function(t){console.log("Error while reading exif data: "+t),e.setState({metadata:{tags:""}})}))},e.loadMetaDataInformation=function(){var t=e.context.getMetadataApiUrl(),n=e.context.davBaseUrl.split("/"),r="/".concat(n[n.length-1]),a={username:e.context.username,homeDir:r,filename:e.props.fileItem.filename,raw:!1};fetch(t,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({metadata:t})})).catch((function(t){console.log("Error while reading metadata: "+t),e.setState({metadata:{tags:""}})}))},e.renderFileItemSize=function(){var t="bytes",n=e.props.fileItem.size;return n>1024&&(n=(n/1024).toFixed(2),t="KB"),n>1024&&(n=(n/1024).toFixed(2),t="MB"),n>1024&&(n=(n/1024).toFixed(2),t="GB"),Object(f.jsxs)("span",{children:[n,"\xa0",t]})},e.renderImageTabs=function(){var t=e.context.isImageFile(e.props.fileItem.basename);return Object(f.jsxs)(T.a,{padding:15,children:[Object(f.jsx)(K.a,{marginBottom:16,flexBasis:240,marginRight:24,children:e.state.tabs.filter((function(e,n){return!(n>0)||t})).map((function(t,n){return Object(f.jsx)(Y.a,{id:t,onSelect:function(){return e.setState({selectedIndex:n})},isSelected:n===e.state.selectedIndex,"aria-controls":"panel-".concat(t),children:t},t)}))}),e.state.tabs.map((function(t,n){var r;switch(n){case 0:r=e.renderFileDetails();break;case 1:r=e.renderImageDetails();break;case 2:r=e.renderMetadataDetails();break;default:r=Object(f.jsx)("div",{})}return Object(f.jsx)(T.a,{id:"panel-".concat(t),role:"tabpanel","aria-labelledby":t,"aria-hidden":n!==e.state.selectedIndex,display:n===e.state.selectedIndex?"block":"none",children:r},t)}))]})},e.renderFileDetails=function(){return Object(f.jsxs)(q.a,{marginTop:15,children:[Object(f.jsxs)(q.a.Head,{height:32,children:[Object(f.jsx)(q.a.TextHeaderCell,{children:Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(f.jsx)(_.a,{}),"\xa0File information"]})}),Object(f.jsx)(q.a.TextHeaderCell,{children:"\xa0"})]}),Object(f.jsxs)(q.a.Body,{children:[Object(f.jsxs)(q.a.Row,{height:32,children:[Object(f.jsx)(q.a.TextCell,{children:"Path:"}),Object(f.jsx)(q.a.TextCell,{children:e.props.fileItem.filename})]},"row_path"),Object(f.jsxs)(q.a.Row,{height:32,children:[Object(f.jsx)(q.a.TextCell,{children:"Last modif:"},"row_modif"),Object(f.jsx)(q.a.TextCell,{children:e.props.fileItem.lastmod})]}),Object(f.jsxs)(q.a.Row,{height:32,children:[Object(f.jsx)(q.a.TextCell,{children:"Size:"},"row_size"),Object(f.jsx)(q.a.TextCell,{children:e.renderFileItemSize()})]})]})]})},e.renderImageDetails=function(){var t;return t="undefined"===typeof e.state.imageData.image?e.renderEmptyDetails("No image information has been found."):Object.keys(e.state.imageData.image).map((function(t,n){return Object(f.jsxs)(q.a.Row,{height:32,children:[Object(f.jsx)(q.a.TextCell,{children:t}),Object(f.jsx)(q.a.TextCell,{children:e.state.imageData.image[t]})]},n)})),Object(f.jsxs)(q.a,{marginTop:15,children:[Object(f.jsxs)(q.a.Head,{height:32,children:[Object(f.jsx)(q.a.TextHeaderCell,{children:Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(f.jsx)(_.a,{}),"\xa0Image information"]})}),Object(f.jsx)(q.a.TextHeaderCell,{children:"\xa0"})]}),Object(f.jsx)(q.a.Body,{children:t})]})},e.renderMetadataDetails=function(){var t;return t="undefined"===typeof e.state.metadata||0===Object.keys(e.state.metadata).length?e.renderEmptyDetails("Metedata details are not available."):Object.keys(e.state.metadata).map((function(t,n){return Object(f.jsxs)(q.a.Row,{height:32,children:[Object(f.jsx)(q.a.TextCell,{children:t}),Object(f.jsx)(q.a.TextCell,{children:e.state.metadata[t]})]},"meta-".concat(n))})),Object(f.jsxs)(q.a,{marginTop:15,children:[Object(f.jsxs)(q.a.Head,{height:32,children:[Object(f.jsx)(q.a.TextHeaderCell,{children:Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(f.jsx)(_.a,{}),"\xa0Metadata information"]})}),Object(f.jsx)(q.a.TextHeaderCell,{children:"\xa0"})]}),Object(f.jsx)(q.a.Body,{children:t})]})},e.renderEmptyDetails=function(e){return Object(f.jsx)(Q.a,{background:"dark",title:"Not found!",orientation:"horizontal",icon:Object(f.jsx)($.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:e})},e.renderTags=function(){if(!e.context.isImageFile(e.props.fileItem.basename))return Object(f.jsx)("div",{children:"\xa0"});var t="Loading tags info...",n=[];return e.state.metadata&&("undefined"!==typeof e.state.metadata.tags&&""!==e.state.metadata.tags&&(n=e.state.metadata.tags.split(",")),t=0===n.length?"No tags for this image":""),Object(f.jsx)(Z.a,{inputProps:{placeholder:t},values:n,flexGrow:2,margin:15,disabled:!0})},e.getRating=function(){return e.context.isImageFile(e.props.fileItem.basename)&&e.state.metadata&&e.state.metadata["xmp:Rating"]?Number.parseInt(e.state.metadata["xmp:Rating"]):0},e.render=function(){var t=Object(f.jsx)(ee.a,{size:24,marginRight:5});return Object(f.jsxs)(T.a,{zIndex:1,flexShrink:0,elevation:0,backgroundColor:"white",children:[Object(f.jsx)(T.a,{padding:16,borderBottom:"muted",children:Object(f.jsx)(I.a,{size:600,children:e.props.fileItem.basename})}),Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(f.jsx)(A.a,{appearance:"primary",intent:"success",is:"a",margin:20,iconBefore:t,href:e.getDownloadLink(),target:"_blank",disabled:!e.context.connectionValid,children:"Download"}),Object(f.jsx)(re,{rating:e.getRating(),maxRating:5,marginRight:10,marginLeft:10})]}),Object(f.jsx)(T.a,{display:"flex",gridTemplateColumns:"auto",children:e.renderTags()}),Object(f.jsx)(T.a,{children:e.renderImageTabs()})]})},e.state={imageData:[],selectedIndex:0,tabs:["Information","Image","Metadata"]},e}return Object(c.a)(n)}(r.Component);ae.contextType=b;var ie=n(361),oe=n(346),ce=n(325),se=n(45),le=n(360),de=n(357),ue=n(358),pe=n(359),je=n(102),he=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a)))._capitalize=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)},e.download=function(t){var n=e.context.davClient.getFileDownloadLink(t.filename);window.open(n,"_blank")},e.renderMimeType=function(t){return"undefined"===typeof t?"File":t.endsWith("json")?"JSON":t.endsWith("xml")?"XML":t.startsWith("application/")?"File":t.startsWith("image/")?e._capitalize(t.substring(6)):t.startsWith("text/")?e._capitalize(t.substring(5))+" Text":t},e.renderHttpDate=function(e){return je.DateTime.fromHTTP(e).toLocaleString(je.DateTime.DATETIME_SHORT_WITH_SECONDS)},e.renderFileItemSize=function(){var t="bytes",n=e.props.fileItem.size;return n>1024&&(n=(n/1024).toFixed(2),t="KB"),n>1024&&(n=(n/1024).toFixed(2),t="MB"),n>1024&&(n=(n/1024).toFixed(2),t="GB"),"".concat(n," ").concat(t)},e.renderGrid=function(){return Object(f.jsxs)(oe.a,{elevation:2,backgroundColor:"white",width:200,height:240,margin:24,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[Object(f.jsx)(T.a,{style:{width:"200px",height:"200px",marginTop:"-15px",display:"flex",justifyContent:"center",alignItems:"center"},background:"tint2",children:Object(f.jsx)(se.a,{icon:de.a,size:48,color:"success"})}),Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",justifyContent:"space-between",style:{width:"190px",height:"18px",margin:"5px"},children:[Object(f.jsx)(ce.a,{href:"#",onClick:function(t){e.props.handleShowDetails(e.props.fileItem)},borderBottom:"none",children:Object(f.jsx)(se.a,{icon:_.a,color:"info"})}),Object(f.jsx)(M.a,{style:{overflow:"hidden",maxWidth:"155px",maxHeight:"24px"},children:e.props.fileItem.basename}),Object(f.jsx)(ce.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:Object(f.jsx)(ee.a,{color:"success"})})]})]})},e.renderActionMenu=function(){return Object(f.jsx)(z.a,{position:G.a.BOTTOM_RIGHT,content:Object(f.jsxs)(H.a,{children:[Object(f.jsxs)(H.a.Group,{children:[Object(f.jsx)(H.a.Item,{icon:_.a,intent:"info",onSelect:function(){e.props.handleShowDetails(e.props.fileItem)},children:"Details..."}),Object(f.jsx)(H.a.Item,{icon:ee.a,intent:"success",onSelect:function(){e.download(e.props.fileItem)},children:"Download..."})]}),Object(f.jsx)(H.a.Group,{children:Object(f.jsx)(H.a.Item,{icon:ue.a,intent:"danger",onSelect:function(){e.props.handleDelete(e.props.fileItem)},children:"Delete"})})]}),children:Object(f.jsx)(A.a,{appearance:"minimal",intent:"none",boxShadow:"none",border:"none",children:Object(f.jsx)(pe.a,{})})})},e.renderTable=function(){return Object(f.jsxs)(q.a.Row,{isSelectable:!0,height:32,children:[Object(f.jsx)(q.a.TextCell,{textAlign:"center",maxWidth:48,children:Object(f.jsx)(de.a,{size:16})}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:Object(f.jsx)(ce.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:e.props.fileItem.basename})}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderMimeType(e.props.fileItem.mime)}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderFileItemSize()}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderHttpDate(e.props.fileItem.lastmod)}),Object(f.jsx)(q.a.TextCell,{textAlign:"center",children:e.renderActionMenu()})]},e.props.fileItem.basename)},e.render=function(){switch(e.props.displayMode){case"grid":return e.renderGrid();case"table":return e.renderTable();default:return console.log("Invalid display mode: ".concat(e.props.displayMode,". Using grid as a default.")),e.renderGrid()}},e}return Object(c.a)(n)}(r.Component);he.contextType=b;var fe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderGrid=function(){return Object(f.jsx)(oe.a,{elevation:2,backgroundColor:"white",width:200,height:240,margin:24,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:Object(f.jsxs)(ce.a,{href:"#",onClick:function(t){return e.props.handleNavigate(e.props.fileItem.basename)},borderBottom:"none",children:[Object(f.jsx)(T.a,{style:{width:"200px",height:"200px",marginTop:"-15px",display:"flex",justifyContent:"center",alignItems:"center"},background:"tint2",children:Object(f.jsx)(se.a,{icon:le.a,size:48,color:"#F7D154"})}),Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",justifyContent:"center",width:190,height:18,margin:5,children:[Object(f.jsx)(le.a,{color:"#F7D154"}),Object(f.jsx)(M.a,{overflow:"hidden",maxWidth:155,maxHeight:24,children:e.props.fileItem.basename})]})]})})},e.renderTable=function(){return Object(f.jsxs)(q.a.Row,{isSelectable:!0,justifyContent:"space-between",height:32,children:[Object(f.jsx)(q.a.TextCell,{textAlign:"center",maxWidth:48,children:Object(f.jsx)(le.a,{color:"#F7D154",size:16})}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:Object(f.jsx)(ce.a,{href:"#",onClick:function(t){return e.props.handleNavigate(e.props.fileItem.basename)},borderBottom:"none",children:e.props.fileItem.basename})}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:"Folder"}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:"\xa0"}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderHttpDate(e.props.fileItem.lastmod)}),Object(f.jsx)(q.a.TextCell,{textAlign:"center",children:e.renderActionMenu()})]},e.props.fileItem.basename)},e}return Object(c.a)(n)}(he),ge=n(51),be=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){e.setState({thumb:null},(function(){return e.generateThumb()}))},e.generateThumb=function(){var t=e.context.davBaseUrl.split("/"),n="/".concat(t[t.length-1]),r={username:e.context.username,homeDir:n,filename:e.props.fileItem.filename},a=Object(ge.a)(e);fetch(e.context.getThumbApiUrl(),{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).then((function(e){return e.blob()})).then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){var e=t.result;a.setState((function(t){return{thumb:e}}))}})).catch((function(t){return console.log("Could not generate thumb for file ".concat(e.props.fileItem.filename,"\nReason: ").concat(t))}))},e.renderGrid=function(){var t={};null!==e.state.thumb&&(t={backgroundImage:"url("+e.state.thumb+")",backgroundPosition:"center",backgroundSize:"cover",width:"200px",height:"200px",marginTop:"-15px"});return Object(f.jsxs)(oe.a,{elevation:2,backgroundColor:"white",width:200,height:240,margin:24,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[Object(f.jsx)("div",{style:t,children:"\xa0"}),Object(f.jsxs)(T.a,{display:"inline-flex",alignItems:"center",justifyContent:"space-between",width:190,height:18,margin:5,children:[Object(f.jsx)(ce.a,{href:"#",borderBottom:"none",onClick:function(t){e.props.handleShowDetails(e.props.fileItem)},children:Object(f.jsx)(se.a,{icon:_.a,color:"info"})}),Object(f.jsx)(M.a,{overflow:"hidden",maxWidth:155,maxHeigh:24,children:e.props.fileItem.basename}),Object(f.jsx)(ce.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:Object(f.jsx)(ee.a,{color:"success"})})]})]})},e.renderTable=function(){var t={};null!==e.state.thumb&&(t={backgroundImage:"url("+e.state.thumb+")",backgroundPosition:"center",backgroundSize:"cover",width:"24px",height:"20px",margin:"0px"});return Object(f.jsxs)(q.a.Row,{isSelectable:!0,justifyContent:"space-between",height:32,children:[Object(f.jsx)(q.a.TextCell,{textAlign:"center",maxWidth:48,children:Object(f.jsx)("div",{style:t})}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:Object(f.jsx)(ce.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:e.props.fileItem.basename})}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderMimeType(e.props.fileItem.mimeType)}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderFileItemSize()}),Object(f.jsx)(q.a.TextCell,{textAlign:"left",children:e.renderHttpDate(e.props.fileItem.lastmod)}),Object(f.jsx)(q.a.TextCell,{textAlign:"center",children:e.renderActionMenu()})]},e.props.fileItem.basename)},e.state={thumb:null},e}return Object(c.a)(n)}(he);be.contextType=b;var xe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidUpdate=function(t){var n=!1,r=e.state.folders;t.folders===e.props.folders&&e.state.currentRegExp===e.context.filterRegExp||(r=e.props.folders.filter((function(t){return-1!==t.basename.search(e.context.filterRegExp)})),n=!0);var a=e.state.files;t.files===e.props.files&&e.state.currentRegExp===e.context.filterRegExp||(a=e.props.files.filter((function(t){return-1!==t.basename.search(e.context.filterRegExp)})),n=!0),n&&e.setState({folders:r,files:a,currentRegExp:e.context.filterRegExp})},e.navigate=function(t){e.setState({filter:"",filterRegExp:new RegExp(".*","i")},(function(){e.props.handleNavigate(t)}))},e.delete=function(t){e.setState({isDeleteDialogShown:!0,fileItemToDelete:t})},e.doDelete=function(){e.setState({isDeleteDialogShown:!1},(function(){e.props.handleDeleteFileItem(e.state.fileItemToDelete)}))},e.renderFolders=function(){return e.state.folders.map((function(t,n){return Object(f.jsx)(fe,{fileItem:t,displayMode:e.props.displayMode,handleNavigate:e.navigate,handleShowDetails:e.props.handleShowDetails,handleDelete:e.delete},"dir_"+n)}))},e.renderFiles=function(){return e.state.files.map((function(t,n){return e.context.isImageFile(t.basename)?Object(f.jsx)(be,{fileItem:t,displayMode:e.props.displayMode,handleShowDetails:e.props.handleShowDetails,handleDelete:e.delete},"file_"+n):Object(f.jsx)(he,{fileItem:t,displayMode:e.props.displayMode,handleShowDetails:e.props.handleShowDetails,handleDelete:e.delete},"file_"+n)}))},e.renderLoadingState=function(){return Object(f.jsx)(Q.a,{background:"light",title:"Loading...",orientation:"horizontal",icon:Object(f.jsx)(U.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"This can take some time depending of the number of folders and files contained in this directory."})},e.renderNothingFound=function(){return Object(f.jsx)(Q.a,{background:"dark",title:"Not found!",orientation:"horizontal",icon:Object(f.jsx)($.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"Nothing matches your search terms. Try something less restrictive?"})},e.renderEmptyState=function(){return Object(f.jsx)(Q.a,{background:"light",title:"Empty directory!",orientation:"horizontal",icon:Object(f.jsx)($.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"It's lonely here... Upload some file here!"})},e.renderFoldersAndFiles=function(){return 0===e.state.folders.length&&0===e.state.files.length?""===e.context.filter?e.renderEmptyState():e.renderNothingFound():Object(f.jsxs)(f.Fragment,{children:[e.renderFolders(),e.renderFiles()]})},e.renderDirectoryContentsGrid=function(){return Object(f.jsx)(T.a,{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",background:"overlay",children:e.props.loading?e.renderLoadingState():e.renderFoldersAndFiles()})},e.renderDirectoryContentsTable=function(){return Object(f.jsxs)(q.a,{children:[Object(f.jsxs)(q.a.Head,{height:32,children:[Object(f.jsx)(q.a.TextHeaderCell,{textAlign:"center",maxWidth:48,children:"\xa0"}),Object(f.jsx)(q.a.TextHeaderCell,{textAlign:"left",children:"Name"}),Object(f.jsx)(q.a.TextHeaderCell,{textAlign:"left",children:"Type"}),Object(f.jsx)(q.a.TextHeaderCell,{textAlign:"left",children:"Size"}),Object(f.jsx)(q.a.TextHeaderCell,{textAlign:"left",children:"Modified"}),Object(f.jsx)(q.a.TextHeaderCell,{textAlign:"center",children:"Actions"})]}),Object(f.jsx)(q.a.Body,{children:e.props.loading?e.renderLoadingState():e.renderFoldersAndFiles()})]})},e.renderDeleteConfirmDialog=function(){return Object(f.jsxs)(ie.a,{isShown:e.state.isDeleteDialogShown,title:"Warning: please confirm...",intent:"danger",onCloseComplete:function(){return e.setState({isDeleteDialogShown:!1})},hasFooter:!1,children:[Object(f.jsxs)(M.a,{children:["Are you sure you want to delete this file? ",Object(f.jsx)("br",{}),null===e.state.fileItemToDelete?"null":e.state.fileItemToDelete.filename]}),Object(f.jsx)("br",{}),Object(f.jsx)(M.a,{intent:"danger",appearance:"primary",children:"This cannot be undone."}),Object(f.jsxs)(T.a,{width:"100%",display:"flex",justifyContent:"right",marginTop:15,children:[Object(f.jsx)(A.a,{is:"div",marginLeft:0,marginRight:12,appearance:"default",intent:"none",onClick:function(t){return e.setState({isDeleteDialogShown:!1})},children:"Cancel"}),Object(f.jsx)(A.a,{is:"div",marginLeft:12,marginRight:0,appearance:"primary",intent:"danger",onClick:function(t){return e.doDelete()},children:"Confirm delete"})]})]})},e.render=function(){var t;switch(e.props.displayMode){case"grid":t=e.renderDirectoryContentsGrid();break;case"table":t=e.renderDirectoryContentsTable();break;default:console.log("Invalid display mode ".concat(e.props.displayMode,". Using grid as a default.")),t=e.renderDirectoryContentsGrid()}return Object(f.jsxs)(f.Fragment,{children:[e.renderDeleteConfirmDialog(),t]})},e.state={files:[],folders:[],currentRegExp:"",isDeleteDialogShown:!1,fileItemToDelete:null},e}return Object(c.a)(n)}(r.Component);xe.contextType=b;var me=n(367),Oe=n(368),ve=n(362),ye=n(363),De=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(){var t=e.props.currentDirectory,n=Object(f.jsx)(ve.a,{size:18,marginLeft:5,marginRight:5}),r=Object(f.jsx)(ye.a,{size:18,marginLeft:5,marginRight:5}),a="/"===t?[""]:t.split("/"),i=[],o=a.map((function(t,a){var o=0===a?r:n;i.push(t);var c=i.join("/");return Object(f.jsxs)(ce.a,{href:"#",display:"flex",alignItems:"center",borderBottom:"none",onClick:function(){e.props.handleNavigate(""===t?"/":c)},children:[o,t]},a+1)}));return Object(f.jsx)(T.a,{display:"flex",padding:8,background:"tint2",children:o})},e}return Object(c.a)(n)}(r.Component),Ce=n(86),we=n(376),Te=n(364),Ie=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).uploadFile=Object(y.a)(C.a.mark((function t(){var n;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.showOpenFilePicker({multiple:!0});case 2:n=t.sent,e.setState({currentUploads:n},(function(){return e.doUploadFiles(n)}));case 4:case"end":return t.stop()}}),t)}))),e.doUploadFiles=function(){var t=Object(y.a)(C.a.mark((function t(n){var r,a,i;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=Object(Ce.a)(n),t.prev=1,i=C.a.mark((function t(){var n,r,i,o;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.value,t.next=3,n.getFile();case 3:r=t.sent,i="".concat(e.props.currentDirectory,"/").concat(r.name),console.log("Target file name is: ".concat(i)),o={contentLength:r.size},e.context.davClient.putFileContents(i,r,o).then((function(t){t?e.props.handleNavigate(e.props.currentDirectory):we.a.danger("File upload problem for ".concat(i))})).catch((function(e){we.a.danger("Problem while uploading file ".concat(i,": ").concat(e))})).finally((function(){var t=e.state.currentUploads.indexOf(n);t>=0?(e.state.currentUploads.splice(t,1),e.setState({currentUploads:e.state.currentUploads})):console.log("Did not find handle of ".concat(n.file.name))}));case 8:case"end":return t.stop()}}),t)})),r.s();case 4:if((a=r.n()).done){t.next=8;break}return t.delegateYield(i(),"t0",6);case 6:t.next=4;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),r.e(t.t1);case 13:return t.prev=13,r.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})));return function(e){return t.apply(this,arguments)}}(),e.render=function(){var t=Object(f.jsx)(f.Fragment,{});return e.state.currentUploads.length>0&&(t=Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(U.a,{size:12,marginRight:5}),Object(f.jsxs)(M.a,{children:[e.state.currentUploads.length," files uploading."]})]})),Object(f.jsxs)(f.Fragment,{children:[t,Object(f.jsx)(A.a,{is:"div",marginLeft:12,marginRight:12,iconBefore:Te.a,appearance:"primary",intent:"success",onClick:function(t){return e.uploadFile()},children:"Upload"})]})},e.state={currentUploads:[]},e}return Object(c.a)(n)}(r.Component);Ie.contextType=b;var Fe=n(70),Se=n(365),ke=n(366),Ae=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).createFolder=Object(y.a)(C.a.mark((function t(){var n;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(e.props.currentDirectory,"/").concat(e.state.newFolderName),t.next=3,e.context.davClient.createDirectory(n);case 3:e.setState({newFolderName:"",popoverShown:!1},(function(){var t=e.state.moveToFolder?n:e.props.currentDirectory;e.props.handleNavigate(t)}));case 4:case"end":return t.stop()}}),t)}))),e.render=function(){return Object(f.jsx)(z.a,{content:function(t){var n=t.close;return Object(f.jsxs)(T.a,{padding:20,display:"grid",alignItems:"left",justifyContent:"left",gridTemplateColumns:"auto auto",gridTemplateRows:"auto auto auto",children:[Object(f.jsx)(M.a,{gridColumnStart:"1",gridColumnEnd:"span 2",children:"New folder name:"}),Object(f.jsx)(Fe.a,{gridColumnStart:"1",gridColumnEnd:"span 2",width:"100%",marginTop:5,value:e.state.newFolderName,onChange:function(t){return e.setState({newFolderName:t.target.value})}}),Object(f.jsx)(Se.a,{gridColumnStart:"1",gridColumnEnd:"span 2",width:"100%",marginTop:5,disabled:""===e.state.newFolderName,label:"Move to new folder afer create",checked:e.state.moveToFolder,onChange:function(t){return e.setState({moveToFolder:!e.state.moveToFolder})}}),Object(f.jsx)(A.a,{is:"div",marginTop:10,marginRight:5,alignSelf:"left",appearance:"primary",intent:"info",disabled:""===e.state.newFolderName,onClick:function(t){return e.createFolder()},children:"Create"}),Object(f.jsx)(A.a,{is:"div",marginTop:10,marginLeft:5,alignSelf:"right",appearance:"default",intent:"none",onClick:n,children:"Close"})]})},children:Object(f.jsx)(A.a,{is:"div",marginLeft:12,marginRight:12,iconBefore:ke.a,appearance:"primary",intent:"info",children:"New folder"})})},e.state={newFolderName:"",moveToFolder:!0},e}return Object(c.a)(n)}(r.Component);Ae.contextType=b;var Re=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).createDirectory=function(e){},e.renderFolderTools=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(Ie,{currentDirectory:e.props.currentDirectory,handleNavigate:e.props.handleNavigate}),Object(f.jsx)(Ae,{currentDirectory:e.props.currentDirectory,handleNavigate:e.props.handleNavigate})]})},e.renderDisplayTools=function(){return Object(f.jsxs)(r.Fragment,{children:[Object(f.jsx)(ce.a,{href:"#",display:"flex",alignItems:"center",onClick:function(t){return e.props.handleDisplayMode("grid")},children:Object(f.jsx)(me.a,{size:18,marginLeft:5,marginRight:5,color:"grid"===e.props.displayMode?"gray600":"blue600"})}),"\xa0",Object(f.jsx)(ce.a,{href:"#",display:"flex",alignItems:"center",onClick:function(t){return e.props.handleDisplayMode("table")},children:Object(f.jsx)(Oe.a,{size:18,marginLeft:5,marginRight:5,color:"table"===e.props.displayMode?"gray600":"blue600"})})]})},e.render=function(){return Object(f.jsxs)(T.a,{zIndex:1,flexShrink:0,background:"tint2",display:"grid",gridTemplateColumns:"auto 1fr",paddingBottom:10,children:[Object(f.jsx)(De,{handleNavigate:e.props.handleNavigate,currentDirectory:e.props.currentDirectory}),Object(f.jsxs)(T.a,{justifySelf:"end",display:"inline-flex",alignItems:"center",children:[e.renderFolderTools(),e.renderDisplayTools()]})]})},e}return Object(c.a)(n)}(r.Component);Re.contextType=b;var Le=function(e){var t=e.children;return Object(f.jsx)("div",{style:{paddingTop:"10px"},children:t})},Me=n(369),Be=n(370),Ue={folderLabel:{display:"grid",justifyItems:"start",gridTemplateColumns:"auto auto 1fr",span:{marginLeft:"5px"},fontFamily:"Lato"},collapsibleOpen:{height:"auto",overflow:"hidden",paddingLeft:"20px"},collapsibleClosed:{height:"0px",overflow:"hidden",paddingLeft:"20px"}},Ne=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidUpdate=function(t,n,r){if(null!==e.props.currentDirectory&&"undefined"!==typeof e.props.currentDirectory&&t.currentDirectory!==e.props.currentDirectory)if(e.props.currentDirectory===e.props.absolutePath&&e.state.isOpen)e.getDirectoryContents();else{var a=e.props.currentDirectory.lastIndexOf("/"),i=e.props.currentDirectory.substring(0,a);e.props.absolutePath===i&&e.state.isOpen&&e.getDirectoryContents()}},e.getDirectoryContents=Object(y.a)(C.a.mark((function t(){var n,r;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],!e.context.connectionValid){t.next=7;break}return t.next=4,e.context.davClient.getDirectoryContents(e.props.absolutePath);case 4:r=t.sent,n=r.filter((function(e){return"directory"===e.type})),e.setState({subDirs:n});case 7:case"end":return t.stop()}}),t)}))),e.handleToggle=function(t){e.setState({isOpen:!e.state.isOpen},(function(){e.state.isOpen&&0===e.state.subDirs.length&&e.getDirectoryContents()}))},e.handleClick=function(t){0===e.state.subDirs.length&&(e.getDirectoryContents(),e.setState({isOpen:!0})),e.props.handleNavigate(e.props.absolutePath)},e.renderSubDirectories=function(){return e.state.subDirs.map((function(t,r){return Object(f.jsx)(n,{basename:t.basename,absolutePath:"".concat(e.props.absolutePath,"/").concat(t.basename),handleNavigate:e.props.handleNavigate,currentDirectory:e.props.currentDirectory},"".concat(e.props.id,"-").concat(r))}))},e.render=function(){var t=e.state.isOpen?Me.a:ve.a,n=e.state.isOpen?Be.a:le.a;return Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{style:Ue.folderLabel,children:[Object(f.jsx)(se.a,{onClick:e.handleToggle,icon:t,size:16,marginRight:"10",cursor:"pointer"}),Object(f.jsxs)("div",{style:Ue.folderLabel,onClick:e.handleClick,children:[Object(f.jsx)(se.a,{icon:n,size:16,color:"#F7D154",cursor:"pointer"}),Object(f.jsx)(M.a,{style:Ue.folderLabel.span,cursor:"pointer",children:e.props.basename})]})]}),Object(f.jsx)("div",{style:e.state.isOpen?Ue.collapsibleOpen:Ue.collapsibleClosed,children:e.renderSubDirectories()})]})},e.state={isOpen:!1,subDirs:[]},e}return Object(c.a)(n)}(r.Component);Ne.contextType=b;var Ee=Ne,ze=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(){return Object(f.jsxs)(T.a,{background:"blueTint",elevation:0,padding:15,display:"grid",gridTemplateRows:"auto auto 1fr",gridTemplateColumns:"auto",overflowX:"scroll",height:"100%",children:[Object(f.jsx)(T.a,{background:"blueTint",children:Object(f.jsx)(I.a,{size:900,color:"neutral",textAlign:"left",children:"My files"})}),Object(f.jsx)(T.a,{background:"blueTint",marginTop:15,children:Object(f.jsx)(I.a,{size:600,color:"neutral",textAlign:"left",children:"File manager"})}),Object(f.jsx)(Le,{children:e.props.rootDirs.map((function(t,n){return Object(f.jsx)(Ee,{id:"treefolder-".concat(n),absolutePath:"/".concat(t.basename),basename:t.basename,handleNavigate:e.props.handleNavigate,currentDirectory:e.props.currentDirectory},"treefolder-".concat(n))}))})]})},e}return Object(c.a)(n)}(r.Component),Ge=ze,He=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){null===e.state.currentDirectory&&e.setState({currentDirectory:"/",loading:!0},(function(){return e.doGetDirectoryContents()}))},e.getDirectoryContents=function(){e.setState({loading:!0},(function(){return e.doGetDirectoryContents()}))},e.doGetDirectoryContents=Object(y.a)(C.a.mark((function t(){var n,r,a;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],r=[],!e.context.connectionValid){t.next=11;break}return t.next=5,e.context.davClient.getDirectoryContents(e.state.currentDirectory);case 5:a=t.sent,n=a.filter((function(e){return"directory"===e.type})),r=a.filter((function(e){return"file"===e.type})),"/"===e.state.currentDirectory&&e.setState({rootDirs:n}),t.next=12;break;case 11:console.error("Cannot get directory contents since connectin is not valid.");case 12:e.setState({directories:n,files:r,loading:!1});case 13:case"end":return t.stop()}}),t)}))),e.navigate=function(t){var n=e.state.currentDirectory.endsWith("/")||t.startsWith("/")?"":"/",r=e.state.currentDirectory+n+t;e.setState((function(e){return{currentDirectory:r,files:[],directories:[]}}),(function(){console.log("Navigated to ".concat(r,", now get directory contents...")),e.getDirectoryContents()}))},e.navigateAbsolute=function(t){e.setState((function(e){return{currentDirectory:t,files:[],directories:[]}}),(function(){console.log("Absolute navigated to ".concat(t,", now get directory contents...")),e.getDirectoryContents()}))},e.toggleFileDetails=function(t){var n=t;n.filename.startsWith(e.context.homeDirectory)&&(n.filename=n.filename.substring(e.context.homeDirectory.length)),e.setState({showDetails:!0,detailedFileItem:n})},e.changeDisplayMode=function(t){e.setState({displayMode:t})},e.deleteFileItem=function(t){e.context.davClient.deleteFile(t.filename).then(e.getDirectoryContents())},e.render=function(){return e.context&&e.context.connectionValid?e.state.currentDirectory?Object(f.jsxs)(T.a,{display:"grid",gridTemplateColumns:"1fr 4fr",height:"100vh",maxHeight:"100vh",overflow:"hidden",children:[Object(f.jsx)(Ge,{rootDirs:e.state.rootDirs,handleNavigate:e.navigateAbsolute,currentDirectory:e.state.currentDirectory}),Object(f.jsxs)(T.a,{display:"grid",gridTemplateRows:"auto auto 1fr",height:"100%",overflowY:"scroll",children:[Object(f.jsx)(X,{}),Object(f.jsx)(Re,{currentDirectory:e.state.currentDirectory,displayMode:e.state.displayMode,handleDisplayMode:e.changeDisplayMode,handleNavigate:e.navigateAbsolute}),Object(f.jsx)(xe,{displayMode:e.state.displayMode,folders:e.state.directories,files:e.state.files,loading:e.state.loading,handleDeleteFileItem:e.deleteFileItem,handleNavigate:e.navigate,handleShowDetails:e.toggleFileDetails})]}),Object(f.jsx)(N.a,{id:"side-details",isShown:e.state.showDetails,onCloseComplete:function(){return e.setState({showDetails:!1})},children:Object(f.jsx)(ae,{fileItem:e.state.detailedFileItem,davClient:e.state.davClient})})]}):Object(f.jsxs)(T.a,{gridTemplateColumns:"auto",children:[Object(f.jsx)(U.a,{marginX:"auto",marginTop:120}),Object(f.jsx)(I.a,{size:600,marginX:"auto",marginTop:15,textAlign:"center",children:"Nico's Drive is loading..."})]}):Object(f.jsx)(v.a,{to:"/login"})},e.state={currentDirectory:null,directories:[],files:[],rootDirs:[],showDetails:!1,displayMode:"table",loading:!0},e}return Object(c.a)(n)}(r.Component);He.contextType=b;n(313);var Pe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).showLoginDialog=function(){e.context.setShowConnectionDialog(!0)},e.render=function(){return Object(f.jsxs)("header",{id:"header",children:[Object(f.jsxs)("div",{className:"content",children:[Object(f.jsx)("h1",{children:Object(f.jsx)("a",{href:"/",children:"Nico's Drive"})}),Object(f.jsxs)("p",{children:["The private online storage solution.",Object(f.jsx)("br",{}),"Backup your memories ... ",Object(f.jsx)("strong",{children:"automatically!"}),Object(f.jsx)("br",{}),"Access your files anytime, anywhere, just like a shared drive,",Object(f.jsx)("br",{}),"On any computer."]}),Object(f.jsxs)("ul",{className:"actions",children:[Object(f.jsx)("li",{children:Object(f.jsx)(A.a,{is:"div",onClick:function(){return window.location.assign("https://github.com/hironico/nico.drive#readme")},appearance:"default",height:60,padding:28,iconBefore:_.a,fontSize:22,children:"Learn more"})}),Object(f.jsx)("li",{children:Object(f.jsx)(A.a,{is:"div",appearance:"primary",intent:"success",height:60,padding:28,iconBefore:R.a,fontSize:22,children:Object(f.jsx)(ce.a,{is:O.b,to:"/login",children:"Login"})})})]})]}),Object(f.jsx)("div",{className:"image phone",children:Object(f.jsx)("div",{className:"inner",children:Object(f.jsx)("img",{src:"images/screen.jpg",alt:""})})})]})},e}return Object(c.a)(n)}(r.Component);Pe.contextType=b;var We=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(){return Object(f.jsx)(m.a,{value:j,children:Object(f.jsx)(x,{children:Object(f.jsx)(O.a,{children:Object(f.jsxs)(v.d,{children:[Object(f.jsx)(v.b,{path:"/",element:Object(f.jsx)(Pe,{})}),Object(f.jsx)(v.b,{path:"login",element:Object(f.jsx)(B,{})}),Object(f.jsx)(v.b,{path:"explorer",element:Object(f.jsx)(He,{})}),Object(f.jsx)(v.b,{path:"*",element:Object(f.jsx)(v.a,{to:"/"})})]})})})})},e}return Object(c.a)(n)}(r.Component),_e=We,Ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,384)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};n(314);o.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(_e,{})}),document.getElementById("root")),Ve()}},[[315,1,2]]]);
//# sourceMappingURL=main.05efa543.chunk.js.map