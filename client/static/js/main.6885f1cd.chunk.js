(this["webpackJsonpnico.drive.client"]=this["webpackJsonpnico.drive.client"]||[]).push([[0],{211:function(e,t){},213:function(e,t){},304:function(e,t,n){},305:function(e,t,n){},307:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(36),o=n.n(i),c=n(13),s=n(12),l=n(14),d=n(16),u=n(139),j=n(133),p=Object(j.merge)({},u.a,{typography:{fontFamilies:{display:"Lato, sans-serif",ui:"Lato, sans-serif",mono:'"SF Mono", monospace'}},components:{Text:{baseStyle:{fontFamily:"Lato, sans-serif"}},Heading:{baseStyle:{fontFamily:"Lato, sans-serif"}},Link:{baseStyle:{fontFamily:"Lato, sans-serif"}}}}),h=n(54),b=n(2),f={davBaseUrl:"http://localhost:8080",davWebContext:"/dav",authType:h.AuthType.Basic,username:"hironico",password:"changeme",davClient:null,connectionValid:!1,homeDirectory:"/hironico",supportedFormats:["JPEG","JPG","PNG","WEBP","AVIF","TIFF","TIF","GIF","SVG","CR2","DNG"],filter:"",filterRegExp:new RegExp(".*","i"),filterFileItems:function(e){},setDavClient:function(e,t){},getClientUrl:function(){},getThumbApiUrl:function(){},getExifApiUrl:function(){},getMetadataApiUrl:function(){},isImageFile:function(){},disconnect:function(){}},x=r.a.createContext(f),g=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).filterFileItems=function(t){var n=null===t||""===t?".*":t;e.setState({filter:t,filterRegExp:new RegExp(n,"i")})},e.setDavClient=function(t,n){var a="undefined"!==typeof n&&null!==n&&""!==n?new URL(n):null,r=a?"".concat(a.protocol,"//").concat(a.host):"",i=a?a.pathname.split("/"):"",o=a?"/".concat(i[0]):"";i=a?i.splice(0,1):[];var c=a?i.join("/"):"";e.setState({davClient:t,davBaseUrl:t?r:"",davWebContext:t?o:"",homeDirectory:t?c:"",connectionValid:!!t})},e.disconnect=function(){e.setDavClient(null,null)},e.getBasePath=function(){return"".concat(e.state.davWebContext).concat(e.state.homeDirectory)},e.getClientUrl=function(){return"".concat(e.state.davBaseUrl).concat(e.state.davWebContext)},e.getThumbApiUrl=function(){return"".concat(e.state.davBaseUrl,"/thumb")},e.getExifApiUrl=function(){return"".concat(e.state.davBaseUrl,"/meta/exif")},e.getMetadataApiUrl=function(){return"".concat(e.state.davBaseUrl,"/meta/xmp")},e.isImageFile=function(t){if("undefined"===typeof t||null===t)return!1;if(t.startsWith("."))return!1;var n=t.lastIndexOf(".");if(n<0)return!1;var a=t.toUpperCase().substring(n+1);return-1!==e.state.supportedFormats.indexOf(a)},e.render=function(){return Object(b.jsx)(x.Provider,{value:e.state,children:e.props.children})},e.state={davBaseUrl:"http://localhost:8080",davWebContext:"/dav",authType:h.AuthType.Basic,username:"hironico",password:"hironico",davClient:null,connectionValid:!1,showConnectionDialog:!1,homeDirectory:"/hironico",supportedFormats:["JPEG","JPG","PNG","WEBP","AVIF","TIFF","GIF","SVG","CR2","DNG"],filter:"",filterRegExp:new RegExp(".*","i"),filterFileItems:e.filterFileItems,setDavClient:e.setDavClient,getClientUrl:e.getClientUrl,getThumbApiUrl:e.getThumbApiUrl,getExifApiUrl:e.getExifApiUrl,getMetadataApiUrl:e.getMetadataApiUrl,isImageFile:e.isImageFile,getBasePath:e.getBasePath,disconnect:e.disconnect},e}return Object(c.a)(n)}(a.Component),m=n(135),O=n(79),y=n(8),v=n(46),C=n(34),D=n.n(C),w=n(140),T=n(35),I=n(141),S=n(356),F=n(55),A=n(142),k=n(42),L=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidUpdate=Object(v.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:""===e.state.url&&e.buildUrl(),null!==e.context.davClient&&e.context.connectionValid&&e.setState({connectionSuccess:!0});case 2:case"end":return t.stop()}}),t)}))),e.buildUrl=function(){var t="localhost"===window.location.hostname?"http":"https",n="localhost"===window.location.hostname?"8080":window.location.port,a="".concat(t,"://").concat(window.location.hostname,":").concat(n,"/").concat(e.state.davContext,"/").concat(e.state.username,"/");e.setState({url:a})},e.testConnection=Object(v.a)(D.a.mark((function t(){var n,a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.info("Testing connection ..."),n={authType:h.AuthType.Basic,username:e.state.username,password:e.state.password},(a=Object(h.createClient)(e.state.url,n)).getDirectoryContents("/").then((function(t){e.context.setDavClient(a,e.state.url)})).catch((function(t){console.info("Could not connect to webdav: ".concat(t)),e.context.setDavClient(null,""),e.setState({errorMessage:"Something went wrong while connecting. Check your credentials and try again.",isLoading:!1,connectionSuccess:!1})}));case 4:case"end":return t.stop()}}),t)}))),e.componentDidMount=function(){e.setState({username:e.context.username,password:e.context.password,url:e.context.getClientUrl()+e.context.homeDirectory,errorMessage:""})},e.onConfirm=function(){e.setState({isLoading:!0,connectionSuccess:!1},(function(){return e.testConnection()}))},e.onTxtLoginChange=function(t){e.setState({username:t.target.value},(function(){e.buildUrl()}))},e.renderErrorMessage=function(){return""!==e.state.errorMessage?Object(b.jsx)(w.a,{intent:"danger",children:e.state.errorMessage}):Object(b.jsx)(b.Fragment,{})},e.renderLoginForm=function(){return Object(b.jsxs)(T.a,{display:"grid",gridTemplateColumns:"auto",margin:160,padding:20,elevation:1,children:[Object(b.jsx)(T.a,{marginTop:-20,marginLeft:-20,marginRight:-20,marginBottom:40,padding:10,background:"tint2",elevation:1,children:Object(b.jsx)(I.a,{is:"h2",textAlign:"center",textShadow:"initial",children:"Welcome to Nico's Drive"})}),Object(b.jsx)(S.a,{id:"txt-login",disabled:e.state.isLoading,value:e.state.username,onChange:e.onTxtLoginChange,placeholder:"Login name...",label:"Login:"}),Object(b.jsx)(S.a,{id:"txt-password",disabled:e.state.isLoading,type:"password",value:e.state.password,onChange:function(t){return e.setState({password:t.target.value})},placeholder:"Password...",label:"Password:"}),Object(b.jsx)(S.a,{id:"txt-url",disabled:e.state.isLoading,value:e.state.url,onChange:function(t){return e.setState({url:t.target.value})},placeholder:"WebDAV URL...",label:"WebDAV base URL:"}),Object(b.jsxs)(T.a,{children:[e.renderErrorMessage(),Object(b.jsx)(F.a,{is:"div",marginTop:16,onClick:function(){return e.onConfirm()},disabled:e.state.isLoading,appearance:"primary",intent:"success",children:e.state.isLoading?"Please wait...":"Connect"}),Object(b.jsx)(A.a,{textAlign:"right",children:Object(b.jsx)(k.a,{children:"Not a member ? Just kindly ask... :)"})})]})]})},e.render=function(){return e.state.connectionSuccess?Object(b.jsx)(y.a,{to:"/explorer"}):e.renderLoginForm()},e.state={isLoading:!1,username:"",password:"",url:"",errorMessage:"",davContext:"dav",connectionSuccess:!1},e}return Object(c.a)(n)}(a.Component);L.contextType=x;var M=n(308),B=n(359),R=n(332),z=n(357),U=n(333),N=n(358),E=n(363),G=n(361),P=n(328),H=n(337),W=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){return Object(b.jsxs)(T.a,{background:"tint2",display:"grid",gridTemplateColumns:"1fr auto",paddingTop:15,paddingBottom:15,paddingLeft:15,justifyItems:"stretch",children:[Object(b.jsx)(R.a,{placeholder:"Search something...",width:"75%",justifySelf:"center",onChange:function(t){return e.context.filterFileItems(t.target.value)},value:e.context.filter}),Object(b.jsx)(z.a,{justifySelf:"end",position:U.a.BOTTOM_RIGHT,content:Object(b.jsxs)(N.a,{children:[Object(b.jsxs)(N.a.Group,{children:[Object(b.jsx)(N.a.Item,{icon:P.a,intent:"success",children:Object(b.jsx)(E.a,{color:"green",children:e.context.username})}),Object(b.jsx)(N.a.Item,{children:e.context.getClientUrl()})]}),Object(b.jsx)(N.a.Divider,{}),Object(b.jsx)(N.a.Group,{children:Object(b.jsx)(N.a.Item,{icon:H.a,intent:"danger",onClick:function(){e.context.disconnect()},children:"Disconnect"})})]}),children:Object(b.jsx)(G.a,{name:e.context.username,size:32,marginLeft:15,marginRight:15,style:{cursor:"pointer"},justifySelf:"end"})})]})},e}return Object(c.a)(n)}(a.Component);W.contextType=x;var _=W,V=n(341),J=n(342),X=n(355),K=n(364),Y=n(343),q=n(339),Q=n(340),Z=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){var t=[],n=e.props.rating?e.props.rating:0,a=e.props.maxRating?e.props.maxRating:5;a<n&&(a=n);for(var r=e.props.size?e.props.size:24,i=0;i<n;i++){var o=Object(b.jsx)(q.a,{color:"#FBE6A2",size:r},i);t.push(o)}for(var c=n;c<a;c++){var s=Object(b.jsx)(Q.a,{color:"#C7CED4",size:r},c);t.push(s)}return Object(b.jsx)(T.a,{display:"inline-fex",alignItems:"center",children:t})},e}return Object(c.a)(n)}(a.Component),$=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){e.loadImageInformation(),e.loadMetaDataInformation()},e.getDownloadLink=function(){if(e.context.connectionValid)return e.context.davClient.getFileDownloadLink(e.props.fileItem.filename)},e.loadImageInformation=function(){var t=e.context.getExifApiUrl(),n={filename:e.props.fileItem.filename};fetch(t,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({imageData:t})})).catch((function(t){console.log("Error while reading exif data: "+t),e.setState({metadata:{tags:""}})}))},e.loadMetaDataInformation=function(){var t=e.context.getMetadataApiUrl(),n={filename:e.props.fileItem.filename,raw:!1};fetch(t,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({metadata:t})})).catch((function(t){console.log("Error while reading metadata: "+t),e.setState({metadata:{tags:""}})}))},e.renderFileItemSize=function(){var t="bytes",n=e.props.fileItem.size;return n>1024&&(n=(n/1024).toFixed(2),t="KB"),n>1024&&(n=(n/1024).toFixed(2),t="MB"),n>1024&&(n=(n/1024).toFixed(2),t="GB"),Object(b.jsxs)("span",{children:[n,"\xa0",t]})},e.renderImageTabs=function(){var t=e.context.isImageFile(e.props.fileItem.basename);return Object(b.jsxs)(T.a,{padding:15,children:[Object(b.jsx)(V.a,{marginBottom:16,flexBasis:240,marginRight:24,children:e.state.tabs.filter((function(e,n){return!(n>0)||t})).map((function(t,n){return Object(b.jsx)(J.a,{id:t,onSelect:function(){return e.setState({selectedIndex:n})},isSelected:n===e.state.selectedIndex,"aria-controls":"panel-".concat(t),children:t},t)}))}),e.state.tabs.map((function(t,n){var a;switch(n){case 0:a=e.renderFileDetails();break;case 1:a=e.renderImageDetails();break;case 2:a=e.renderMetadataDetails();break;default:a=Object(b.jsx)("div",{})}return Object(b.jsx)(T.a,{id:"panel-".concat(t),role:"tabpanel","aria-labelledby":t,"aria-hidden":n!==e.state.selectedIndex,display:n===e.state.selectedIndex?"block":"none",children:a},t)}))]})},e.renderFileDetails=function(){return Object(b.jsxs)(X.a,{marginTop:15,children:[Object(b.jsxs)(X.a.Head,{height:32,children:[Object(b.jsx)(X.a.TextHeaderCell,{children:Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(b.jsx)(P.a,{}),"\xa0File information"]})}),Object(b.jsx)(X.a.TextHeaderCell,{children:"\xa0"})]}),Object(b.jsxs)(X.a.Body,{children:[Object(b.jsxs)(X.a.Row,{height:32,children:[Object(b.jsx)(X.a.TextCell,{children:"Path:"}),Object(b.jsx)(X.a.TextCell,{children:e.props.fileItem.filename})]},"row_path"),Object(b.jsxs)(X.a.Row,{height:32,children:[Object(b.jsx)(X.a.TextCell,{children:"Last modif:"},"row_modif"),Object(b.jsx)(X.a.TextCell,{children:e.props.fileItem.lastmod})]}),Object(b.jsxs)(X.a.Row,{height:32,children:[Object(b.jsx)(X.a.TextCell,{children:"Size:"},"row_size"),Object(b.jsx)(X.a.TextCell,{children:e.renderFileItemSize()})]})]})]})},e.renderImageDetails=function(){if("undefined"===typeof e.state.imageData.image)return Object(b.jsx)(a.Fragment,{children:"\xa0"});var t=Object.keys(e.state.imageData.image).map((function(t,n){return Object(b.jsxs)(X.a.Row,{children:[Object(b.jsx)(X.a.TextCell,{children:t}),Object(b.jsx)(X.a.TextCell,{children:e.state.imageData.image[t]})]},n)}));return Object(b.jsxs)(X.a,{marginTop:15,children:[Object(b.jsxs)(X.a.Head,{children:[Object(b.jsx)(X.a.TextHeaderCell,{children:Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(b.jsx)(P.a,{}),"\xa0Image information"]})}),Object(b.jsx)(X.a.TextHeaderCell,{children:"\xa0"})]}),Object(b.jsx)(X.a.Body,{children:t})]})},e.renderMetadataDetails=function(){if("undefined"===typeof e.state.metadata)return Object(b.jsx)(a.Fragment,{children:"\xa0"});var t=Object.keys(e.state.metadata).map((function(t,n){return Object(b.jsxs)(X.a.Row,{children:[Object(b.jsx)(X.a.TextCell,{children:t}),Object(b.jsx)(X.a.TextCell,{children:e.state.metadata[t]})]},"meta-".concat(n))}));return Object(b.jsxs)(X.a,{marginTop:15,children:[Object(b.jsxs)(X.a.Head,{children:[Object(b.jsx)(X.a.TextHeaderCell,{children:Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(b.jsx)(P.a,{}),"\xa0Metadata information"]})}),Object(b.jsx)(X.a.TextHeaderCell,{children:"\xa0"})]}),Object(b.jsx)(X.a.Body,{children:t})]})},e.renderTags=function(){if(!e.context.isImageFile(e.props.fileItem.basename))return Object(b.jsx)("div",{children:"\xa0"});var t="Loading tags info...",n=[];return e.state.metadata&&("undefined"!==typeof e.state.metadata.tags&&""!==e.state.metadata.tags&&(n=e.state.metadata.tags.split(",")),t=0===n.length?"No tags for this image":""),Object(b.jsx)(K.a,{inputProps:{placeholder:t},values:n,flexGrow:2,margin:15,disabled:!0})},e.getRating=function(){return e.context.isImageFile(e.props.fileItem.basename)&&e.state.metadata&&e.state.metadata["xmp:Rating"]?Number.parseInt(e.state.metadata["xmp:Rating"]):0},e.render=function(){var t=Object(b.jsx)(Y.a,{size:24,marginRight:5});return Object(b.jsxs)(T.a,{zIndex:1,flexShrink:0,elevation:0,backgroundColor:"white",children:[Object(b.jsx)(T.a,{padding:16,borderBottom:"muted",children:Object(b.jsx)(I.a,{size:600,children:e.props.fileItem.basename})}),Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",children:[Object(b.jsx)(F.a,{appearance:"primary",intent:"success",is:"a",margin:20,iconBefore:t,href:e.getDownloadLink(),target:"_blank",disabled:!e.context.connectionValid,children:"Download"}),Object(b.jsx)(Z,{rating:e.getRating(),maxRating:5,marginRight:10,marginLeft:10})]}),Object(b.jsx)(T.a,{display:"flex",gridTemplateColumns:"auto",children:e.renderTags()}),Object(b.jsx)(T.a,{children:e.renderImageTabs()})]})},e.state={imageData:[],selectedIndex:0,tabs:["Information","Image","Metadata"]},e}return Object(c.a)(n)}(a.Component);$.contextType=x;var ee=n(347),te=n(336),ne=n(313),ae=n(41),re=n(346),ie=n(344),oe=n(345),ce=n(93),se=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r)))._capitalize=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)},e.download=function(t){var n=e.context.davClient.getFileDownloadLink(t.filename);window.open(n,"_blank")},e.renderMimeType=function(t){return"undefined"===typeof t?"File":t.endsWith("json")?"JSON":t.endsWith("xml")?"XML":t.startsWith("application/")?"File":t.startsWith("image/")?e._capitalize(t.substring(6)):t.startsWith("text/")?e._capitalize(t.substring(5))+" Text":t},e.renderHttpDate=function(e){return ce.DateTime.fromHTTP(e).toLocaleString(ce.DateTime.DATETIME_SHORT_WITH_SECONDS)},e.renderFileItemSize=function(){var t="bytes",n=e.props.fileItem.size;return n>1024&&(n=(n/1024).toFixed(2),t="KB"),n>1024&&(n=(n/1024).toFixed(2),t="MB"),n>1024&&(n=(n/1024).toFixed(2),t="GB"),"".concat(n," ").concat(t)},e.renderGrid=function(){return Object(b.jsxs)(te.a,{elevation:2,backgroundColor:"white",width:200,height:240,margin:24,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[Object(b.jsx)(T.a,{style:{width:"200px",height:"200px",marginTop:"-15px",display:"flex",justifyContent:"center",alignItems:"center"},background:"tint2",children:Object(b.jsx)(ae.a,{icon:ie.a,size:48,color:"success"})}),Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",justifyContent:"space-between",style:{width:"190px",height:"18px",margin:"5px"},children:[Object(b.jsx)(ne.a,{href:"#",onClick:function(t){e.props.handleShowDetails(e.props.fileItem)},borderBottom:"none",children:Object(b.jsx)(ae.a,{icon:P.a,color:"info"})}),Object(b.jsx)(k.a,{style:{overflow:"hidden",maxWidth:"155px",maxHeight:"24px"},children:e.props.fileItem.basename}),Object(b.jsx)(ne.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:Object(b.jsx)(Y.a,{color:"success"})})]})]})},e.renderActionMenu=function(){return Object(b.jsx)(z.a,{position:U.a.BOTTOM_RIGHT,content:Object(b.jsx)(N.a,{children:Object(b.jsxs)(N.a.Group,{children:[Object(b.jsx)(N.a.Item,{icon:P.a,intent:"info",onSelect:function(){e.props.handleShowDetails(e.props.fileItem)},children:"Details..."}),Object(b.jsx)(N.a.Item,{icon:Y.a,intent:"success",onSelect:function(){e.download(e.props.fileItem)},children:"Download..."})]})}),children:Object(b.jsx)(F.a,{appearance:"minimal",intent:"none",boxShadow:"none",border:"none",children:Object(b.jsx)(oe.a,{})})})},e.renderTable=function(){return Object(b.jsxs)(X.a.Row,{isSelectable:!0,height:32,children:[Object(b.jsx)(X.a.TextCell,{textAlign:"center",maxWidth:48,children:Object(b.jsx)(ie.a,{size:16})}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:Object(b.jsx)(ne.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:e.props.fileItem.basename})}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderMimeType(e.props.fileItem.mime)}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderFileItemSize()}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderHttpDate(e.props.fileItem.lastmod)}),Object(b.jsx)(X.a.TextCell,{textAlign:"center",children:e.renderActionMenu()})]},e.props.fileItem.basename)},e.render=function(){switch(e.props.displayMode){case"grid":return e.renderGrid();case"table":return e.renderTable();default:return console.log("Invalid display mode: ".concat(e.props.displayMode,". Using grid as a default.")),e.renderGrid()}},e}return Object(c.a)(n)}(a.Component);se.contextType=x;var le=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).renderGrid=function(){return Object(b.jsx)(te.a,{elevation:2,backgroundColor:"white",width:200,height:240,margin:24,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:Object(b.jsxs)(ne.a,{href:"#",onClick:function(t){return e.props.handleNavigate(e.props.fileItem.basename)},borderBottom:"none",children:[Object(b.jsx)(T.a,{style:{width:"200px",height:"200px",marginTop:"-15px",display:"flex",justifyContent:"center",alignItems:"center"},background:"tint2",children:Object(b.jsx)(ae.a,{icon:re.a,size:48,color:"#F7D154"})}),Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",justifyContent:"center",width:190,height:18,margin:5,children:[Object(b.jsx)(re.a,{color:"#F7D154"}),Object(b.jsx)(k.a,{overflow:"hidden",maxWidth:155,maxHeight:24,children:e.props.fileItem.basename})]})]})})},e.renderTable=function(){return Object(b.jsxs)(X.a.Row,{isSelectable:!0,justifyContent:"space-between",height:32,children:[Object(b.jsx)(X.a.TextCell,{textAlign:"center",maxWidth:48,children:Object(b.jsx)(re.a,{color:"#F7D154",size:16})}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:Object(b.jsx)(ne.a,{href:"#",onClick:function(t){return e.props.handleNavigate(e.props.fileItem.basename)},borderBottom:"none",children:e.props.fileItem.basename})}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:"Folder"}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:"\xa0"}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderHttpDate(e.props.fileItem.lastmod)}),Object(b.jsx)(X.a.TextCell,{textAlign:"center",children:"\xa0"})]},e.props.fileItem.basename)},e}return Object(c.a)(n)}(se),de=n(74),ue=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){e.setState({thumb:null},(function(){return e.generateThumb()}))},e.generateThumb=function(){var t={filename:e.props.fileItem.filename},n=Object(de.a)(e);fetch(e.context.getThumbApiUrl(),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(e){return e.blob()})).then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){var e=t.result;n.setState((function(t){return{thumb:e}}))}})).catch((function(t){return console.log("Could not generate thumb for file ".concat(e.props.fileItem.filename,"\nReason: ").concat(t))}))},e.renderGrid=function(){var t={};null!==e.state.thumb&&(t={backgroundImage:"url("+e.state.thumb+")",backgroundPosition:"center",backgroundSize:"cover",width:"200px",height:"200px",marginTop:"-15px"});return Object(b.jsxs)(te.a,{elevation:2,backgroundColor:"white",width:200,height:240,margin:24,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[Object(b.jsx)("div",{style:t,children:"\xa0"}),Object(b.jsxs)(T.a,{display:"inline-flex",alignItems:"center",justifyContent:"space-between",width:190,height:18,margin:5,children:[Object(b.jsx)(ne.a,{href:"#",borderBottom:"none",onClick:function(t){e.props.handleShowDetails(e.props.fileItem)},children:Object(b.jsx)(ae.a,{icon:P.a,color:"info"})}),Object(b.jsx)(k.a,{overflow:"hidden",maxWidth:155,maxHeigh:24,children:e.props.fileItem.basename}),Object(b.jsx)(ne.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:Object(b.jsx)(Y.a,{color:"success"})})]})]})},e.renderTable=function(){var t={};null!==e.state.thumb&&(t={backgroundImage:"url("+e.state.thumb+")",backgroundPosition:"center",backgroundSize:"cover",width:"24px",height:"20px",margin:"0px"});return Object(b.jsxs)(X.a.Row,{isSelectable:!0,justifyContent:"space-between",height:32,children:[Object(b.jsx)(X.a.TextCell,{textAlign:"center",maxWidth:48,children:Object(b.jsx)("div",{style:t})}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:Object(b.jsx)(ne.a,{href:e.context.davClient.getFileDownloadLink(e.props.fileItem.filename),target:"_blank",borderBottom:"none",children:e.props.fileItem.basename})}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderMimeType(e.props.fileItem.mimeType)}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderFileItemSize()}),Object(b.jsx)(X.a.TextCell,{textAlign:"left",children:e.renderHttpDate(e.props.fileItem.lastmod)}),Object(b.jsx)(X.a.TextCell,{textAlign:"center",children:e.renderActionMenu()})]},e.props.fileItem.basename)},e.state={thumb:null},e}return Object(c.a)(n)}(se);ue.contextType=x;var je=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).navigate=function(t){e.setState({filter:"",filterRegExp:new RegExp(".*","i")},(function(){e.props.handleNavigate(t)}))},e.renderFolders=function(){return e.props.folders.filter((function(t){return-1!==t.basename.search(e.context.filterRegExp)})).map((function(t,n){return Object(b.jsx)(le,{fileItem:t,displayMode:e.props.displayMode,handleNavigate:e.navigate,handleShowDetails:e.props.handleShowDetails},"dir_"+n)}))},e.renderFiles=function(){return e.props.files.filter((function(t){return-1!==t.basename.search(e.context.filterRegExp)})).map((function(t,n){return e.context.isImageFile(t.basename)?Object(b.jsx)(ue,{fileItem:t,displayMode:e.props.displayMode,handleShowDetails:e.props.handleShowDetails},"file_"+n):Object(b.jsx)(se,{fileItem:t,displayMode:e.props.displayMode,handleShowDetails:e.props.handleShowDetails},"file_"+n)}))},e.renderLoadingState=function(){return Object(b.jsx)(ee.a,{background:"light",title:"Loading...",orientation:"horizontal",icon:Object(b.jsx)(M.a,{color:"#C1C4D6"}),iconBgColor:"#EDEFF5",description:"This can take some time depending of the number of folders and files contained in this directory."})},e.renderFoldersAndFiles=function(){return Object(b.jsxs)(b.Fragment,{children:[e.renderFolders(),e.renderFiles()]})},e.renderDirectoryContentsGrid=function(){return Object(b.jsx)(T.a,{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",background:"overlay",children:e.props.loading?e.renderLoadingState():e.renderFoldersAndFiles()})},e.renderDirectoryContentsTable=function(){return Object(b.jsxs)(X.a,{children:[Object(b.jsxs)(X.a.Head,{height:32,children:[Object(b.jsx)(X.a.TextHeaderCell,{textAlign:"center",maxWidth:48,children:"\xa0"}),Object(b.jsx)(X.a.TextHeaderCell,{textAlign:"left",children:"Name"}),Object(b.jsx)(X.a.TextHeaderCell,{textAlign:"left",children:"Type"}),Object(b.jsx)(X.a.TextHeaderCell,{textAlign:"left",children:"Size"}),Object(b.jsx)(X.a.TextHeaderCell,{textAlign:"left",children:"Modified"}),Object(b.jsx)(X.a.TextHeaderCell,{textAlign:"center",children:"Actions"})]}),Object(b.jsx)(X.a.Body,{children:e.props.loading?e.renderLoadingState():e.renderFoldersAndFiles()})]})},e.render=function(){var t;switch(e.props.displayMode){case"grid":t=e.renderDirectoryContentsGrid();break;case"table":t=e.renderDirectoryContentsTable();break;default:console.log("Invalid display mode ".concat(e.props.displayMode,". Using grid as a default.")),t=e.renderDirectoryContentsGrid()}return t},e}return Object(c.a)(n)}(a.Component);je.contextType=x;var pe=n(350),he=n(351),be=n(348),fe=n(349),xe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){var t=e.props.currentDirectory,n=Object(b.jsx)(be.a,{size:18,marginLeft:5,marginRight:5}),a=Object(b.jsx)(fe.a,{size:18,marginLeft:5,marginRight:5}),r="/"===t?[""]:t.split("/"),i=[],o=r.map((function(t,r){var o=0===r?a:n;i.push(t);var c=i.join("/");return Object(b.jsxs)(ne.a,{href:"#",display:"flex",alignItems:"center",borderBottom:"none",onClick:function(){e.props.handleNavigate(""===t?"/":c)},children:[o,t]},r+1)}));return Object(b.jsx)(T.a,{display:"flex",padding:8,background:"tint2",children:o})},e}return Object(c.a)(n)}(a.Component),ge=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderDisplayTools=function(){return Object(b.jsxs)(a.Fragment,{children:[Object(b.jsx)(ne.a,{href:"#",style:{display:"flex",alignItems:"center"},onClick:function(t){return e.props.handleDisplayMode("grid")},children:Object(b.jsx)(pe.a,{size:18,style:{marginLeft:"5px",marginRight:"5px"}})}),"\xa0",Object(b.jsx)(ne.a,{href:"#",style:{display:"flex",alignItems:"center"},onClick:function(t){return e.props.handleDisplayMode("table")},children:Object(b.jsx)(he.a,{size:18,style:{marginLeft:"5px",marginRight:"5px"}})})]})},e.render=function(){return Object(b.jsxs)(T.a,{zIndex:1,flexShrink:0,background:"tint2",display:"grid",gridTemplateColumns:"auto 1fr",children:[Object(b.jsx)(xe,{handleNavigate:e.props.handleNavigate,currentDirectory:e.props.currentDirectory}),Object(b.jsx)(T.a,{justifySelf:"end",display:"inline-flex",alignItems:"center",children:e.renderDisplayTools()})]})},e}return Object(c.a)(n)}(a.Component);ge.contextType=x;var me=function(e){var t=e.children;return Object(b.jsx)("div",{style:{paddingTop:"10px"},children:t})},Oe=n(352),ye=n(353),ve={folderLabel:{display:"grid",justifyItems:"start",gridTemplateColumns:"auto auto 1fr",span:{marginLeft:"5px"},fontFamily:"Lato"},collapsibleOpen:{height:"auto",overflow:"hidden",paddingLeft:"20px"},collapsibleClosed:{height:"0px",overflow:"hidden",paddingLeft:"20px"}},Ce=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).getDirectoryContents=Object(v.a)(D.a.mark((function t(){var n,a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],!e.context.connectionValid){t.next=7;break}return t.next=4,e.context.davClient.getDirectoryContents(e.props.absolutePath);case 4:a=t.sent,n=a.filter((function(e){return"directory"===e.type})),e.setState({subDirs:n});case 7:case"end":return t.stop()}}),t)}))),e.handleToggle=function(t){e.setState({isOpen:!e.state.isOpen},(function(){e.state.isOpen&&0===e.state.subDirs.length&&e.getDirectoryContents()}))},e.handleClick=function(t){0===e.state.subDirs.length&&(e.getDirectoryContents(),e.setState({isOpen:!0})),e.props.handleNavigate(e.props.absolutePath)},e.renderSubDirectories=function(){return e.state.subDirs.map((function(t,a){return Object(b.jsx)(n,{basename:t.basename,absolutePath:"".concat(e.props.absolutePath,"/").concat(t.basename),handleNavigate:e.props.handleNavigate},"".concat(e.props.id,"-").concat(a))}))},e.render=function(){var t=e.state.isOpen?Oe.a:be.a,n=e.state.isOpen?ye.a:re.a;return Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{style:ve.folderLabel,children:[Object(b.jsx)(ae.a,{onClick:e.handleToggle,icon:t,size:16,marginRight:"10",cursor:"pointer"}),Object(b.jsxs)("div",{style:ve.folderLabel,onClick:e.handleClick,children:[Object(b.jsx)(ae.a,{icon:n,size:16,color:"#F7D154",cursor:"pointer"}),Object(b.jsx)(k.a,{style:ve.folderLabel.span,cursor:"pointer",children:e.props.basename})]})]}),Object(b.jsx)("div",{style:e.state.isOpen?ve.collapsibleOpen:ve.collapsibleClosed,children:e.renderSubDirectories()})]})},e.state={isOpen:!1,subDirs:[]},e}return Object(c.a)(n)}(a.Component);Ce.contextType=x;var De=Ce,we=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){return Object(b.jsxs)(T.a,{background:"blueTint",elevation:0,padding:15,display:"grid",gridTemplateRows:"auto auto 1fr",gridTemplateColumns:"auto",overflowX:"scroll",height:"100%",children:[Object(b.jsx)(T.a,{background:"blueTint",children:Object(b.jsx)(I.a,{size:900,color:"neutral",textAlign:"left",children:"My files"})}),Object(b.jsx)(T.a,{background:"blueTint",marginTop:15,children:Object(b.jsx)(I.a,{size:600,color:"neutral",textAlign:"left",children:"File manager"})}),Object(b.jsx)(me,{children:e.props.rootDirs.map((function(t,n){return Object(b.jsx)(De,{id:"treefolder-".concat(n),absolutePath:"/".concat(t.basename),basename:t.basename,handleNavigate:e.props.handleNavigate},"treefolder-".concat(n))}))})]})},e}return Object(c.a)(n)}(a.Component),Te=we,Ie=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).componentDidMount=function(){console.info("Dav Explorer Component did mount. setting current directory to /..."),null===e.state.currentDirectory&&e.setState({currentDirectory:"/",loading:!0},(function(){return e.doGetDirectoryContents()}))},e.getDirectoryContents=function(){e.setState({loading:!0},(function(){return e.doGetDirectoryContents()}))},e.doGetDirectoryContents=Object(v.a)(D.a.mark((function t(){var n,a,r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],a=[],!e.context.connectionValid){t.next=11;break}return t.next=5,e.context.davClient.getDirectoryContents(e.state.currentDirectory);case 5:r=t.sent,n=r.filter((function(e){return"directory"===e.type})),a=r.filter((function(e){return"file"===e.type})),"/"===e.state.currentDirectory&&e.setState({rootDirs:n}),t.next=12;break;case 11:console.error("Cannot get directory contents since connectin is not valid.");case 12:e.setState({directories:n,files:a,loading:!1});case 13:case"end":return t.stop()}}),t)}))),e.navigate=function(t){var n=e.state.currentDirectory.endsWith("/")||t.startsWith("/")?"":"/",a=e.state.currentDirectory+n+t;e.setState((function(e){return{currentDirectory:a,files:[],directories:[]}}),(function(){console.log("Navigated to ".concat(a,", now get directory contents...")),e.getDirectoryContents()}))},e.navigateAbsolute=function(t){e.setState((function(e){return{currentDirectory:t,files:[],directories:[]}}),(function(){console.log("Absolute navigated to ".concat(t,", now get directory contents...")),e.getDirectoryContents()}))},e.toggleFileDetails=function(t){var n=t;n.filename.startsWith(e.context.homeDirectory)&&(n.filename=n.filename.substring(e.context.homeDirectory.length)),e.setState({showDetails:!0,detailedFileItem:n})},e.changeDisplayMode=function(t){e.setState({displayMode:t})},e.render=function(){return e.context&&e.context.connectionValid?e.state.currentDirectory?Object(b.jsxs)(T.a,{display:"grid",gridTemplateColumns:"1fr 4fr",height:"100vh",maxHeight:"100vh",overflow:"hidden",children:[Object(b.jsx)(Te,{rootDirs:e.state.rootDirs,handleNavigate:e.navigateAbsolute}),Object(b.jsxs)(T.a,{display:"grid",gridTemplateRows:"auto auto 1fr",height:"100%",overflowY:"scroll",children:[Object(b.jsx)(_,{}),Object(b.jsx)(ge,{currentDirectory:e.state.currentDirectory,handleDisplayMode:e.changeDisplayMode,handleNavigate:e.navigateAbsolute}),Object(b.jsx)(je,{displayMode:e.state.displayMode,folders:e.state.directories,files:e.state.files,loading:e.state.loading,handleNavigate:e.navigate,handleShowDetails:e.toggleFileDetails})]}),Object(b.jsx)(B.a,{id:"side-details",isShown:e.state.showDetails,onCloseComplete:function(){return e.setState({showDetails:!1})},children:Object(b.jsx)($,{fileItem:e.state.detailedFileItem,davClient:e.state.davClient})})]}):Object(b.jsxs)(T.a,{gridTemplateColumns:"auto",children:[Object(b.jsx)(M.a,{marginX:"auto",marginTop:120}),Object(b.jsx)(I.a,{size:600,marginX:"auto",marginTop:15,textAlign:"center",children:"Nico's Drive is loading..."})]}):Object(b.jsx)(y.a,{to:"/login"})},console.log("DavExplorerPane constrcutor..."),e.state={currentDirectory:null,directories:[],files:[],rootDirs:[],showDetails:!1,displayMode:"table",loading:!1},e}return Object(c.a)(n)}(a.Component);Ie.contextType=x;var Se=n(354),Fe=(n(304),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).showLoginDialog=function(){e.context.setShowConnectionDialog(!0)},e.render=function(){return Object(b.jsxs)("header",{id:"header",children:[Object(b.jsxs)("div",{className:"content",children:[Object(b.jsx)("h1",{children:Object(b.jsx)("a",{href:"/",children:"Nico's Drive"})}),Object(b.jsxs)("p",{children:["The private online storage solution.",Object(b.jsx)("br",{}),"Backup your memories ... ",Object(b.jsx)("strong",{children:"automatically!"}),Object(b.jsx)("br",{}),"Access your files anytime, anywhere, just like a shared drive,",Object(b.jsx)("br",{}),"On any computer."]}),Object(b.jsxs)("ul",{className:"actions",children:[Object(b.jsx)("li",{children:Object(b.jsx)(F.a,{is:"div",onClick:function(){return window.location.assign("https://github.com/hironico/nico.drive#readme")},appearance:"default",height:60,padding:28,iconBefore:P.a,fontSize:22,children:"Learn more"})}),Object(b.jsx)("li",{children:Object(b.jsx)(F.a,{is:"div",appearance:"primary",intent:"success",height:60,padding:28,iconBefore:Se.a,fontSize:22,children:Object(b.jsx)(ne.a,{is:O.b,to:"/login",children:"Login"})})})]})]}),Object(b.jsx)("div",{className:"image phone",children:Object(b.jsx)("div",{className:"inner",children:Object(b.jsx)("img",{src:"images/screen.jpg",alt:""})})})]})},e}return Object(c.a)(n)}(a.Component));Fe.contextType=x;var Ae=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).render=function(){return Object(b.jsx)(m.a,{value:p,children:Object(b.jsx)(g,{children:Object(b.jsx)(O.a,{children:Object(b.jsxs)(y.d,{children:[Object(b.jsx)(y.b,{path:"/",element:Object(b.jsx)(Fe,{})}),Object(b.jsx)(y.b,{path:"login",element:Object(b.jsx)(L,{})}),Object(b.jsx)(y.b,{path:"explorer",element:Object(b.jsx)(Ie,{})}),Object(b.jsx)(y.b,{path:"*",element:Object(b.jsx)(y.a,{to:"/"})})]})})})})},e}return Object(c.a)(n)}(a.Component),ke=Ae,Le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,365)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),i(e),o(e)}))};n(305);o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(ke,{})}),document.getElementById("root")),Le()}},[[307,1,2]]]);
//# sourceMappingURL=main.6885f1cd.chunk.js.map